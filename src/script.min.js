function main(){Array.prototype.clear=function(){this.splice(0,this.length)};window.log=function(){log.history=log.history||[];log.history.push(arguments);if(this.console)console.log(Array.prototype.slice.call(arguments))};var I={title:"Social HnS",logged:false,loginFocus:false,registerFocus:false,currentPage:"",profileID:0,loadedLeft:[],loadedContent:[],loadedProfile:[],loadedRight:[],user:{},profileUser:{},streamUpdates:{},newestUpdate:0,oldestUpdate:0,newerUpdates:0,moreUpdates:true,currentTime:0,streamInterval:false,timestamp:Date.now||function(){return+new Date},timestamp_sec:parseInt(Date.now/1000)||function(){return parseInt(+new Date/1000)},today:function(a){var b=new Date(I.timestamp());return(a.getDate()==b.getDate()&&a.getMonth()==b.getMonth()&&a.getYear()==b.getYear())},yesterday:function(a){var b=new Date(I.timestamp()-86400000);return(a.getDate()==b.getDate()&&a.getMonth()==b.getMonth()&&a.getYear()==b.getYear())},stringToBoolean:function(a){switch(a.toLowerCase()){case"true":case"yes":case"1":return true;case"false":case"no":case"0":case null:return false;default:return false}},empty:function(a){var b;if(a===""||a===0||a==="0"||a===null||a===false||typeof a==='undefined')return true;if(typeof a=='object'){for(b in a)return false;return true}return false},addSlashes:function(a){return(a+'').replace(/[\\"']/g,'\\$&').replace(/\u0000/g,'\\0')},stripSlashes:function(b){return(b+'').replace(/\\(.?)/g,function(s,a){switch(a){case'\\':return'\\';case'0':return'\u0000';case'':return'';default:return a}})},setPage:function(a){I.currentPage=a},setTitle:function(a,b){if(!b){if(!a)document.title=I.title;else document.title=I.title+" | "+a}else{document.title=a}},setHash:function(a){if(!a)window.location.replace("#");else window.location.replace("#"+encodeURI(a))},getHash:function(){return decodeURIComponent(window.location.hash.substring(1))},init:function(){$.get('ajax.php',{p:"logged"},function(a){if(I.stringToBoolean(a))I.logged=true;if(!I.logged){I.loadModule('login');$.post('ajax.php',{offlineUpdate:true,hash:I.getHash()})}else I.loggedIn()})},loadModule:function(b){if(!arguments[1]||$.isFunction(arguments[1]))var c="content";else var c=arguments[1];if(b=="login"&&I.logged){I.loadedLeft.clear();I.loadedContent.clear();I.loadedProfile.clear();I.loadedRight.clear();$("#left,#content,#right,#header").empty()}switch(c){case"left":if($.inArray(b,I.loadedLeft)>-1){$("#left").show().children().hide();$("#"+b).show();return}break;case"content":if($.inArray(b,I.loadedContent)>-1){$("#content").children().hide();$("#"+b).show();var d=['profile','about','photos','friends','posts','likes'];if($.inArray(I.currentPage,d)==-1){if($("#right").is(":hidden"))I.toggleModule('right')}return}break;case"profile":if($.inArray(b,I.loadedProfile)>-1){return}break;case"right":if($.inArray(b,I.loadedRight)>-1){$("#right").show().children().hide();$("#"+b).show();return}break}$.get('ajax.php',{p:b},function(a){switch(c){case"left":I.loadedLeft.push(b);$("#left").show().children().hide();break;case"content":I.loadedContent.push(b);$("#content").children().hide();break;case"right":I.loadedRight.push(b);$("#right").show().children().hide();break}$("#"+c).append(a);if(I.currentPage=="newsfeed"){$(".loadingMostRecent,.loadingMore").hide();$(".loadMore").css('display','block')}})},toggleModule:function(a,b){if(a=="left"){if($("#left").is(":hidden")){$("#left").animate({width:200},600);$("#body").animate({left:200},600)}else{$("#left").animate({width:0},400);$("#body").animate({left:0},400)}}else if(a=="right"){if($("#right").is(":hidden")){$("#right").show();$("#content").css('width',568)}else{$("#right").hide();$("#content").css('width',778)}}},loggedIn:function(){if(I.logged){$.getJSON('ajax.php',{p:"userdata"},function(a){I.user=a;if(I.user.middlename!="")I.user.fullname=I.user.firstname+' '+I.user.middlename+' '+I.user.lastname;else I.user.fullname=I.user.firstname+' '+I.user.lastname});if(I.empty(I.getHash())){$("#content").empty();I.setPage('newsfeed');I.loadModule('home_newsfeed');I.loadModule('home_leftcol','left');I.loadModule('home_rightcol','right');I.loadModule('header','header');$("#left").animate({width:200},600);$("#right").animate({width:210},600);$("#body").animate({left:200},600,function(){$("#doc").addClass("in").removeClass("out");$('.updateNewsFeed').click()})}else{$("#content").empty();I.setPage('newsfeed');I.loadModule('home_newsfeed');I.loadModule('home_leftcol','left');I.loadModule('home_rightcol','right');I.loadModule('header','header');$("#left").animate({width:200},600);$("#right").animate({width:210},600);$("#body").animate({left:200},600,function(){$("#doc").addClass("in").removeClass("out");$('.updateNewsFeed').click()})}I.streamInterval=setInterval(function(){I.checkStreamUpdates()},30000)}},login:function(){var e=false,username=$("#lusername"),password=$("#lpassword");if($.trim(username.val())==""){username.addClass('error');e=true}else username.removeClass('error');if($.trim(password.val())==""){password.addClass('error');e=true}else password.removeClass('error');if(!e){$('#f_login input').attr('disabled',true);$.post("ajax.php",{login:true,username:$.trim(username.val()),password:secure('hns'+$.trim(password.val()))},function(a){if(I.stringToBoolean(a))I.logged=true;if(!I.logged)$('#f_login input').attr('disabled',false);else I.loggedIn()})}},logout:function(){$.post('ajax.php',{logout:true},function(){$("#left,#right").animate({width:0},400,function(){$("#left,#right").empty()});I.setPage('login');I.setTitle();I.setHash();I.loadModule('login');I.logged=false;$("#body").animate({left:0},400,function(){$("#doc").addClass("out").removeClass("in")});I.profileID=0;I.loadedLeft.clear();I.loadedContent.clear();I.loadedProfile.clear();I.loadedRight.clear();I.user={};I.profileUser={};I.streamUpdates={};I.newestUpdate=0;I.oldestUpdate=0;I.newerUpdates=0;I.moreUpdates=true;clearInterval(I.streamInterval)})},regValidate:function(){var e=false,username=$("#reg_username"),password=$("#reg_password"),name=$("#reg_name"),email=$("#reg_email"),hometown=$("#reg_hometown"),city=$("#reg_city"),bmonth=$("#reg_bmonth"),bday=$("#reg_bday"),byear=$("#reg_byear"),usernameReg=/\W/,nameReg=/[A-Za-z'-]/,emailReg=/^[^0-9][a-zA-Z0-9_]+([.][a-zA-Z0-9_]+)*[@][a-zA-Z0-9_]+([.][a-zA-Z0-9_]+)*[.][a-zA-Z]{2,4}?$/i;if($.trim(username.val())==""){username.addClass('error');e=true}else if(usernameReg.test($.trim(username.val()))){username.addClass('error');e=true}else{I.checkUsername($.trim(username.val()));if(username.hasClass('error'))e=true}if($.trim(password.val())==""){password.addClass('error');e=true}else password.removeClass('error');if($.trim(name.val())==""){name.addClass('error');e=true}else if(!nameReg.test($.trim(name.val()))){name.addClass('error');e=true}else if($.trim(name.val()).split(' ').length<2){name.addClass('error');e=true}else name.removeClass('error');if($.trim(email.val())==""){email.addClass('error');e=true}else if(!emailReg.test($.trim(email.val()))){email.addClass('error');e=true}else email.removeClass('error');if($.trim(hometown.val())==""){hometown.addClass('error');e=true}else hometown.removeClass('error');if(bmonth.val()==0){bmonth.addClass('error');e=true}else bmonth.removeClass('error');if(bday.val()==0){bday.addClass('error');e=true}else bday.removeClass('error');if(byear.val()==0){byear.addClass('error');e=true}else byear.removeClass('error');if(e)return false;else return true},checkUsername:function(b){if(b!=""){$.get('ajax.php',{p:"username",username:b},function(a){if(I.stringToBoolean(a))$("#reg_username").addClass('error');else $("#reg_username").removeClass('error')})}else $("#reg_username").addClass('error')},onKeyDown:function(e){var a=e.keyCode||e.which;if(I.logged){}else{if(a==13){if(I.loginFocus)$("#b_login_splash").click();else if(I.registerFocus)$("#b_register").click()}}},handleError:function(a){return a},addNewStatusUpdate:function(a,b){var c=new Date(),hours=c.getHours(),prefix="AM",minutes=c.getMinutes(),seconds=c.getSeconds();if(hours>12){hours=hours-12;prefix="PM"}else if(hours==0)hours=12;if(minutes<10){minutes='0'+minutes}if(seconds<10){seconds='0'+seconds}var d=['January','February','March','April','May','June','July','August','September','October','November','December'];var e=['Sunday','Monday','Tuesday','Wednesday','Thursday','Friday','Saturday'];var f=hours+":"+minutes+":"+seconds+" "+prefix;var g=e[c.getDay()]+", "+d[c.getMonth()]+" "+c.getDate()+", "+c.getFullYear()+" "+f;var h=hours+":"+minutes+" "+prefix;var s='<li id="update-'+a+'" class="streamItem" style="display:none">';s+='<div class="updateWrapper"><div class="updateTitle">';s+='<a href="#" class="updateImageLink"><img class="updateImg" src="/uploads/'+I.user.username+'/images/thumb/'+I.user.default_image+'"/></a>';s+='<div class="updateNameDate"><a href="#" class="updateNameLink">'+I.user.fullname+'</a>';s+='<span class="updateDate">&nbsp;&nbsp;-&nbsp;&nbsp;<a href="#" class="updateDateLink" target="_blank" title="'+g+'">'+h+'</a></span>';s+='<span class="updateEdit">&nbsp;&nbsp;<span class="link updateEditLink">Edit</span></span>';s+='</div></div>';s+='<div class="updateBody">'+I.stripSlashes(b)+'</div>';s+='<div class="editUpdateBody"><div class="buttonTools cf"><ul class="toolList lfloat">';s+='<li class="listItem"><label class="saveEditUpdateButton" for="saveEdit"><input value="Save" type="submit" name="saveEdit" class="saveEditUpdate"/></label></li>';s+='<li class="listItem"><label class="cancelEditUpdateButton" for="cancelEdit"><input value="Cancel" type="submit" name="cancelEdit" class="cancelEditUpdate"/></label></li>';s+='</ul></div></div>';s+='<div class="updateAttachments"></div>';s+='<div class="updateActions">';s+='<ul class="streamActions">';s+='<li class="updateLinks"><span class="link updateLikeLink">Like</span>&nbsp;&nbsp;-&nbsp;&nbsp;<span class="link updateCommentLink">Comment</span>&nbsp;&nbsp;-&nbsp;&nbsp;<span class="link updateShareLink">Share</span></li>';s+='<li class="updateLikes"></li>';s+='<li class="updateShares"></li>';s+='<li class="updateOlderComments clickable"></li>';s+='<li class="updateComments"></li>';s+='<li class="updateNewComments clickable"></li>';s+='<li class="updateLikes"><span class="link updateLikesLink"><span class="count"></span> <span class="updateLikesCount>like</span></span> by <span class="list"></span> others</li>';s+='<li class="updateShares"><span class="link updateSharesLink"><span class="count"></span> <span class="updateSharesCount">share</span></span> - <span class="list"></span></li>';s+='<li class="updateOlderComments clickable"><span class="link updateOlderCommentsLink"><span class="count"></span> older comments</span> from <span class="list"></span></li>';s+='<li class="updateComments"><ul class="streamComments"><li></li></ul></li>';s+='<li class="updateNewComments clickable"><span class="link updateNewCommentsLink"><span class="count"></span> more comments</span> from <span class="list"></span></li>';s+='<li class="updateComment">';s+='<div class="updateCommentBox">';s+='<form class="f_updateComment" action="#" method="post" onsubmit="return false">';s+='<div id="updateComposer"><div class="commentBox"><div class="wrap"><div class="innerWrap">';s+='<textarea class="textarea" placeholder="Add a comment..." cols="30" rows="4"></textarea>';s+='</div></div></div></div>';s+='<div class="buttonTools cf"><ul class="toolList rfloat">';s+='<li class="listItem"><label class="commentButton" for="comment"><input value="Add comment" type="submit" name="comment" class="comment"/></label></li>';s+='</ul></div></form></div></li></ul></div></div></li>';return s},addStatusUpdates:function(G,H){var s="";I.streamUpdates=G;I.currentTime=I.timestamp_sec();$.each(G,function(i,v){if(H=="new"){if(i==0)I.newestUpdate=v.timestamp;if(I.oldestUpdate==0&&i==G.length-1)I.oldestUpdate=v.timestamp}else if(H=="old"){if(i==G.length-1)I.oldestUpdate=v.timestamp}var a=new Date(),currentDate=a.getDate();var b=new Date(parseInt(v.timestamp+'000')),hours=b.getHours(),prefix="AM",minutes=b.getMinutes(),seconds=b.getSeconds();if(hours>12){hours=hours-12;prefix="PM"}else if(hours==0)hours=12;if(minutes<10){minutes='0'+minutes}if(seconds<10){seconds='0'+seconds}var c=['January','February','March','April','May','June','July','August','September','October','November','December'];var d=['Jan','Feb','Mar','Apr','May','June','July','Aug','Sept','Oct','Nov','Dec'];var e=['Sunday','Monday','Tuesday','Wednesday','Thursday','Friday','Saturday'];var f=hours+":"+minutes+":"+seconds+" "+prefix;var g=e[b.getDay()]+", "+c[b.getMonth()]+" "+b.getDate()+", "+b.getFullYear()+" "+f;var h=hours+":"+minutes+" "+prefix;if(I.yesterday(b))var h="Yesterday "+h;else if(!I.today(b))var h=d[b.getMonth()]+" "+b.getDate()+", "+b.getFullYear();if(v.default_image!="")var j="/uploads/"+v.username+"/images/thumb/"+v.default_image;else var j="i/mem/default.jpg";if(v.middlename!="")var k=v.firstname+" "+v.middlename+" "+v.lastname;else var k=v.firstname+" "+v.lastname;var l="";var m="";var n=0;var o="";var p=0;var q="";var r=0;var t="";var u=0;var w="likes";var x="shares";var y="comments";var z="comments";if(v.likes==1)w="like";if(n==1)x="share";if(p==1)y="comment";if(u==1)z="comment";if(v.likes>0){if($.inArray(I.user.user_id,v.ids)>-1){if(v.likes==1)l="You";else l="You and "+v.likes-1+" others"}else{l=v.likes+" others"}}if(n>0){if($.inArray(I.user.user_id,v.ids)>-1){if(v.likes==1)m="You";else m="You and "+v.likes-1+" others"}else{m=v.likes+" others"}}if(p>0){if($.inArray(I.user.user_id,v.ids)>-1){if(v.likes==1)l="You";else l="You and "+v.likes-1+" others"}else{l=v.likes+" others"}}if(u>0){if($.inArray(I.user.user_id,v.ids)>-1){if(v.likes==1)l="You";else l="You and "+v.likes-1+" others"}else{l=v.likes+" others"}}var A="";if(v.likes>0)A=" active";var B="";if(n>0)B=" active";var C="";if(p!="")C=" active";var D="";if(r!="")D=" active";var E="";if(t!="")E=" active";var F="";if(v.likes>0||m!=""||o!=""||q!=""||t!="")F=" active";s+='<li id="update-'+v.sid+'" class="streamItem">';s+='<div class="updateWrapper"><div class="updateTitle">';s+='<a href="#" class="updateImageLink"><img class="updateImg" src="'+j+'"/></a>';s+='<div class="updateNameDate"><a href="#" class="updateNameLink">'+k+'</a>';s+='<span class="updateDate">&nbsp;&nbsp;-&nbsp;&nbsp;<a href="#" class="updateDateLink" target="_blank" title="'+g+'">'+h+'</a></span>';if(v.owner==I.user.user_id)s+='<span class="updateEdit">&nbsp;&nbsp;<span class="link updateEditLink">Edit</span></span>';s+='</div></div>';s+='<div class="updateBody">'+I.stripSlashes(v.data)+'</div>';s+='<div class="editUpdateBody"><div class="buttonTools cf"><ul class="toolList lfloat">';s+='<li class="listItem"><label class="saveEditUpdateButton" for="saveEdit"><input value="Save" type="submit" name="saveEdit" class="saveEditUpdate"/></label></li>';s+='<li class="listItem"><label class="cancelEditUpdateButton" for="cancelEdit"><input value="Cancel" type="submit" name="cancelEdit" class="cancelEditUpdate"/></label></li>';s+='</ul></div></div>';s+='<div class="updateAttachments"></div>';s+='<div class="updateActions">';s+='<ul class="streamActions">';s+='<li class="updateLinks"><span class="link updateLikeLink">Like</span>&nbsp;&nbsp;-&nbsp;&nbsp;<span class="link updateCommentLink">Comment</span>&nbsp;&nbsp;-&nbsp;&nbsp;<span class="link updateShareLink">Share</span></li>';s+='<li class="updateLikes'+A+'"><span class="link updateLikesLink"><span class="count">'+v.likes+'</span> <span class="updateLikesCount">'+w+'</span></span> by <span class="list">'+l+'</span></li>';s+='<li class="updateShares'+B+'"><span class="link updateSharesLink"><span class="count">'+n+'</span> <span class="updateSharesCount">'+x+'</span></a> - <span class="list">'+m+'</span></li>';s+='<li class="updateOlderComments clickable'+C+'"><span class="link updateOlderCommentsLink"><span class="count">'+p+'</span> older <span class="updateOldCommentsCount">'+y+'</span></span> from <span class="list">'+o+'</span></li>';s+='<li class="updateComments'+D+'"><ul class="streamComments"><li>'+q+'</li></ul></li>';s+='<li class="updateNewComments clickable'+E+'"><span class="link updateNewCommentsLink"><span class="count">'+u+'</span> more <span class="updateNewCommentsCount">'+z+'</span></span> from <span class="list">'+t+'</span></li>';s+='<li class="updateComment'+F+'">';s+='<div class="updateCommentBox">';s+='<form class="f_updateComment" action="#" method="post" onsubmit="return false">';s+='<div id="updateComposer"><div class="commentBox"><div class="wrap"><div class="innerWrap">';s+='<textarea class="textarea" placeholder="Add a comment..." cols="30" rows="4"></textarea>';s+='</div></div></div></div>';s+='<div class="buttonTools cf"><ul class="toolList rfloat">';s+='<li class="listItem"><label class="commentButton" for="comment"><input value="Add comment" type="submit" name="comment" class="comment"/></label></li>';s+='</ul></div></form></div></li></ul></div></div></li>'});return s},addNewComment:function(a,b){var d=new Date(),hours=d.getHours(),prefix="AM",minutes=d.getMinutes(),seconds=d.getSeconds();if(hours>12){hours=hours-12;prefix="PM"}else if(hours==0)hours=12;if(minutes<10){minutes='0'+minutes}if(seconds<10){seconds='0'+seconds}var e=['January','February','March','April','May','June','July','August','September','October','November','December'];var f=['Sunday','Monday','Tuesday','Wednesday','Thursday','Friday','Saturday'];var g=hours+":"+minutes+":"+seconds+" "+prefix;var h=f[d.getDay()]+", "+e[d.getMonth()]+" "+d.getDate()+", "+d.getFullYear()+" "+g;var i=hours+":"+minutes+" "+prefix;var c='<li id="comment-'+a+'">';c+='<div class="commentWrapper">';c+='<div class="commentContent">';c+='<a href="#" class="commentImageLink"><img class="commentImg" src="/uploads/'+I.user.username+'/images/thumb/'+I.user.default_image+'"/></a>';c+='<div class="commentNameBody">';c+='<a href="#" class="commentNameLink">'+I.user.fullname+'</a> - <span class="commentBody">'+b+'</span>';c+='</div>';c+='<span class="expandComment"><span class="link expandCommentLink">Expand this comment &#187;</span></span>';c+='<span class="collapseComment"><span class="link collapseCommentLink">Collapse this comment</span></span>';c+='<div class="commentTimeTools">';c+='<span class="commentTime" title="'+h+'">'+i+'</span></span>&nbsp;&nbsp;';c+='<span class="commentTools"><span class="link commentLikeLink">Like</span></span>';c+='</div>';c+='</div>';c+='</div>';c+='</li>';return c},addComments:function(a,b,d,e,f){var g=new Date(b),hours=g.getHours(),prefix="AM",minutes=g.getMinutes(),seconds=g.getSeconds();if(hours>12){hours=hours-12;prefix="PM"}else if(hours==0)hours=12;if(minutes<10){minutes='0'+minutes}if(seconds<10){seconds='0'+seconds}var h=['January','February','March','April','May','June','July','August','September','October','November','December'];var i=['Sunday','Monday','Tuesday','Wednesday','Thursday','Friday','Saturday'];var j=hours+":"+minutes+":"+seconds+" "+prefix;var k=i[g.getDay()]+", "+h[g.getMonth()]+" "+g.getDate()+", "+g.getFullYear()+" "+j;var l=hours+":"+minutes+" "+prefix;if(I.yesterday(g))var l="Yesterday "+l;else if(!I.today(g))var l=monthShortArray[g.getMonth()]+" "+g.getDate()+", "+g.getFullYear();var c='<li id="comment-'+a+'">';c+='<div class="commentWrapper">';c+='<div class="commentContent">';c+='<a href="#" class="commentImageLink"><img class="commentImg" src="'+e+'"/></a>';c+='<div class="commentNameBody">';c+='<a href="#" class="commentNameLink">'+f+'</a> - <span class="commentBody">'+d+'</span>';c+='</div>';c+='<span class="expandComment"><span class="link expandCommentLink">Expand this comment &#187;</span></span>';c+='<span class="collapseComment"><span class="link collapseCommentLink">Collapse this comment</span></span>';c+='<div class="commentTimeTools">';c+='<span class="commentTime" title="'+k+'">'+l+'</span></span>&nbsp;&nbsp;';c+='<span class="commentTools"><span class="link commentLikeLink">Like</span></span>';c+='</div>';c+='</div>';c+='</div>';c+='</li>';return c},bbCode:function(a){return true},checkStreamUpdates:function(){$.getJSON('ajax.php',{p:"stream",newest:I.newestUpdate,hash:I.getHash()},function(a){if(a!="0"){var b=a["data"].length;I.newerUpdates=b;$(".mostRecentCount").find(".mostRecentCountValue").html(b).end().show();$("ul.sideNav #newsFeedLink .sideNavCount").find(".countValue").html(b).end().show()}})}};$(document.documentElement).keydown(I.onKeyDown);$(document).ready(function(){I.init();$(".homeLink").live('click',function(){if(I.logged){if(I.currentPage!="newsfeed"){I.setPage('newsfeed');I.setTitle();I.setHash();I.loadModule('home_newsfeed');I.loadModule('home_leftcol','left');I.loadModule('home_rightcol','right');$("#newsFeedLink").click()}}else{I.setPage('login');I.setTitle();I.setHash();I.loadModule('login')}});$("#lusername, #lpassword").live('focus',function(){I.loginFocus=true}).live('blur',function(){I.loginFocus=false});$("#b_login_splash").live('click',function(){I.login()});$("#b_register_splash").live('click',function(){I.loadModule('register');I.setTitle('Register');I.setHash('register')});$("#reg_username, #reg_password, #reg_name, #reg_email, #reg_hometown, #reg_city").live('focus',function(){I.registerFocus=true}).live('blur',function(){I.registerFocus=false});$("#reg_username").live('blur',function(){I.checkUsername($.trim(this.value))});$("#b_register").live('click',function(){if(!I.regValidate())return;$('#f_register input,#f_register select').attr('disabled',true);$.post("ajax.php",{register:true,username:$.trim($("#reg_username").val()),password:$.trim($("#reg_password").val()),name:$.trim($("#reg_name").val()),email:$.trim($("#reg_email").val()),hometown:$.trim($("#reg_hometown").val()),city:$.trim($("#reg_city").val()),gender:$.trim($("#reg_gender").val()),bmonth:$("#reg_bmonth").val(),bday:$("#reg_bday").val(),byear:$("#reg_byear").val()},function(){I.logged=true;I.loggedIn()})});$("#b_login").live('click',function(){I.setPage('login');I.setTitle();I.setHash();I.loadModule('login')});$("#headerLogoutLink").live('click',function(){I.logout()});$(".welcome_image, .welcome_name, .profileLink").live('click',function(){if(I.currentPage!="profile"){I.setPage('profile');I.setTitle(I.user.fullname,true);I.setHash('profile');I.toggleModule('right');I.loadModule('profile');I.loadModule('profile_leftcol','left');$("#wallLink").click()}});$(".welcome_editlink").live('click',function(){if(I.currentPage!="edit"){I.setPage('edit');I.loadModule('edit')}});$(".sideNavItem").live('click',function(){if(!$(this).hasClass('selectedItem')){$(".sideNav").children().removeClass("selectedItem");$(this).addClass("selectedItem")}});$("#newsFeedLink").live('click',function(){if(I.currentPage!="newsfeed"){I.setPage('newsfeed');I.loadModule('home_newsfeed')}});$("#messagesLink").live('click',function(){if(I.currentPage!="messages"){I.setPage('messages');I.loadModule('messages')}});$("#friendsLink").live('click',function(){if(I.currentPage!="profile"){I.setPage('profile');I.setTitle(I.user.fullname,true);I.setHash('profile');I.toggleModule('right');I.loadModule('profile');I.loadModule('profile_leftcol','left');$("#friendsLink").click()}});$("#wallLink").live('click',function(){if(I.currentPage!="profile"){I.setPage('profile');I.loadModule('profile')}});$("#infoLink").live('click',function(){if(I.currentPage!="about"){I.setPage('about');I.loadModule('about')}});$("#photosLink").live('click',function(){if(I.currentPage!="photos"){I.setPage('photos');I.loadModule('photos')}});$(".updateStatus .textarea").live('focus',function(){$(this).css('max-height',400);$(".updateStatus .buttonTools").show()}).live('blur',function(){if($(this).val()==""){$(this).css('max-height',16);$(".updateStatus .buttonTools").hide()}});$("#share").live('click',function(){if($.trim($(".updateStatus .textarea").val()).length>0){$.post("ajax.php",{p:"status",data:$.trim($(".updateStatus .textarea").val())},function(a){if(a!="0"){a=$.parseJSON(a);if(I.newerUpdates>0)$(".updateNewsFeed").click();else I.newestUpdate=I.timestamp_sec;var s=I.addNewStatusUpdate(a["data"].insertid,a["data"].status);$(".updateStatus .textarea").val('').blur();$("ul#stream").prepend(s).find("li.active").prev().addClass("borderActive").end().end().find("li:first").fadeIn()}})}});$("ul#stream > li").live('click',function(){$("ul#stream > li").removeClass('active borderActive');$(this).addClass('active').prev().addClass('borderActive').end().next().addClass('borderActive')});$(".updateEditLink").live('click',function(){var a=$(this).closest('.streamItem');a.find('.updateBody').attr('contenteditable','true').focus().end().find('.editUpdateBody').addClass("active")});$(".saveEditUpdate").live('click',function(){var a=$(this).closest('.streamItem');var b=a.attr('id').substring(7);a.find('.updateBody').removeAttr('contenteditable').end().find('.editUpdateBody').removeClass("active");var c=a.find('.updateBody').html();$.each(I.streamUpdates,function(i,v){if(v.sid==b)I.streamUpdates[i].data=c})});$(".cancelEditUpdate").live('click',function(){var a=$(this).closest('.streamItem');var b=a.attr('id').substring(7);a.find('.updateBody').removeAttr('contenteditable').end().find('.editUpdateBody').removeClass("active");$.each(I.streamUpdates,function(i,v){if(v.sid==b)a.find('.updateBody').html(v.data)})});$(".updateLikeLink").live('click',function(){var c=$(this).closest('.streamItem');var d=c.attr('id').substring(7);$.post("ajax.php",{p:"like",oid:d},function(a){if(a!="0"){var b=c.find(".updateLikes");alert(b.html());if(c.hasClass("active")){b.find(".count").html(parseInt(b.find(".count").html())+1)}else{b.find(".count").html('1');b.addClass("active")}}})});$(".updateCommentLink").live('click',function(){$(this).parent().parent().find(".updateComment").addClass("active").find('.textarea').focus()});$(".updateComment .textarea").live('focus',function(){$(this).css('max-height',300).parents().eq(4).find(".buttonTools").show()}).live('blur',function(){if($(this).val()==""){$(this).css('max-height',16).parents().eq(4).find(".buttonTools").hide()}});$(".comment").live('click',function(){var b=$(this).closest('.streamItem');var d=$.trim(b.find(".updateComment .textarea").val());var e=b.attr('id').substring(7);if(d.length>0){$.post("ajax.php",{p:"comment",data:d,oid:e},function(a){if(a!="0"){var c=I.addNewComment(a,d);b.find(".updateComment .textarea").val('').blur();b.find(".streamComments").append(c);b.find(".updateComments").addClass("active");b.find(".streamComments li:last").fadeIn()}})}});$(".updateNewsFeed").live('click',function(){$(".mostRecentCount").hide().find(".mostRecentCountValue").empty();$("ul.sideNav #newsFeedLink .sideNavCount").hide().find(".countValue").empty();I.newerUpdates=0;$(".loadingMostRecent").css('display','block');$.getJSON('ajax.php',{p:"stream",newest:I.newestUpdate},function(a){if(a!="0"){var s=I.addStatusUpdates(a["data"],"new");$("ul#stream").prepend(s).find("li.active").prev().addClass("borderActive");I.streamUpdates=a["data"].concat(I.streamUpdates)}$(".loadingMostRecent").hide()})});$(".loadMore").live('click',function(){if(I.newestUpdate==0)return;$(this).hide();$(".loadingMore").css('display','block');$.getJSON('ajax.php',{p:"stream",oldest:I.oldestUpdate},function(a){if(a!="0"){var s=I.addStatusUpdates(a["data"],"old");$("ul#stream").append(s).find("li.active").next().addClass("borderActive");if(a["data"].length<30){$("ul#stream").append('<div class="moreUpdates">No More Updates Available!</div>');I.moreUpdates=false;$(".loadMoreLink").hide()}I.streamUpdates.concat(a["data"]);alert(I.streamUpdates.length)}else{if(I.moreUpdates&&I.newestUpdate>0){$("ul#stream").append('<div class="moreUpdates">No More Updates Available!</div>');I.moreUpdates=false;$(".loadMoreLink").hide()}}$(".loadingMore").hide();$(".loadMore").show()})})});function encode(a){if(a===null||typeof a==="undefined"){return""}var b=(a+'');var c="",start,end,stringl=0;start=end=0;stringl=b.length;for(var n=0;n<stringl;n++){var d=b.charCodeAt(n);var e=null;if(d<128){end++}else if(d>127&&d<2048){e=String.fromCharCode((d>>6)|192)+String.fromCharCode((d&63)|128)}else{e=String.fromCharCode((d>>12)|224)+String.fromCharCode(((d>>6)&63)|128)+String.fromCharCode((d&63)|128)}if(e!==null){if(end>start){c+=b.slice(start,end)}c+=e;start=end=n+1}}if(end>start){c+=b.slice(start,stringl)}return c}function secure(a){var b="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=";var c,o2,o3,h1,h2,h3,h4,bits,i=0,ac=0,enc="",tmp_arr=[];if(!a){return a}a=encode(a+'');do{c=a.charCodeAt(i++);o2=a.charCodeAt(i++);o3=a.charCodeAt(i++);bits=c<<16|o2<<8|o3;h1=bits>>18&0x3f;h2=bits>>12&0x3f;h3=bits>>6&0x3f;h4=bits&0x3f;tmp_arr[ac++]=b.charAt(h1)+b.charAt(h2)+b.charAt(h3)+b.charAt(h4)}while(i<a.length);enc=tmp_arr.join('');switch(a.length%3){case 1:enc=enc.slice(0,-2)+'==';break;case 2:enc=enc.slice(0,-1)+'=';break}return enc}return true}window.$&&main()||(function(){var a=document.createElement("script");a.setAttribute("type","text/javascript");a.setAttribute("src","jquery.js");a.onload=main;a.onreadystatechange=function(){if(this.readyState=="complete"||this.readyState=="loaded")main()};(document.getElementsByTagName("head")[0]||document.documentElement).appendChild(a)})();